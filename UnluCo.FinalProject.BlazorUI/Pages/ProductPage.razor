@page "/products/{id:int}"
@inherits ProductViewModel
@using Newtonsoft.Json
<h3>Product Page</h3>

@if (Product is null)
{
    <p>
        Loading...

    </p>
}
else
{
<div class="col">


    <div class="row bg-light">
        <div class="m-auto">
            @if (Product.UploadedFile is not null)
            {
                <img class="col-12 mb-2" src="data:image;base64,@System.Convert.ToBase64String(Product.UploadedFile.FileContent)" asp-append-version="true" style="height:400px;width:400px">
            }
        </div>


        @*<p class="col-2 m-1">User: @Product.User.UserName</p>*@


    </div>
    <div class="row">
        <div class="col-12">
            <span class="col-1 m-1">Id: @Product.Id</span>
            <span class="col-3 m-1">Name: @Product.Name</span>

            <span class="col-2 m-1">Price: @Product.Price</span>
            <span class="col-2 m-1">Color: @Product.Color.Name</span>
            <span class="col-3 m-1">Category: @Product.Category.Title</span>
            <span class="col-3 m-1">Brand: @Product.Brand.Name</span>
            <span class="col-12 m-1">Description: @Product.Description</span>
        </div>
    </div>
    <hr class="bg-dark" />
    @if (Product.Offers.Count > 0)
    {
        <h4 class="row">Offers</h4>

        @foreach (var item in Product.Offers)
        {
            <div class="row bg-white">
                <ul>
                    <li>Offer Id: @item.Id</li>
                    <li>Amout: @item.Amount</li>
                </ul>
            </div>
            <hr class="bg-dark" />
        }

    }

</div>
  
}

@code {
    [Parameter]
    public int Id { get; set; }

    public ProductViewModel Product { get; set; }

    HttpClient client = new HttpClient();


    protected override async Task OnInitializedAsync()
    {
        var product = await client.GetAsync($"http://localhost:19383/api/products/{Id}");
        Product = JsonConvert.DeserializeObject<ProductViewModel>(await product.Content.ReadAsStringAsync());
    }

}

